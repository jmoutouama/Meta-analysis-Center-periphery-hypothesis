dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
#label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 1,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = -1,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="normal")
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain")
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain")
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
(Figure3 <ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
(Figure3 <ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
(Figure3 <-ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
(Figure3 <-ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
widths = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
(Figure3 <-ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
(Figure3 <-ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain")))
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
Figure3 <-ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf", width = 5, height = 7)
# (Figure3 <- ggarrange(Figure3a,Figure3b))
Figure3 <-ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),      # equal width for both panels
align = "v",           # horizontal alignment
labels = c("a","b"),   # add panel labels
label.x = 0,  # shift labels outside left
label.y = 1.02,        # above panel
font.label = list(size = 14),face ="plain"))
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf",
width = 5, height = 7)
# Assign ggarrange to Figure3
Figure3 <- ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),        # equal height for vertical layout
align = "v",             # vertical alignment
labels = c("a","b"),     # add panel labels
label.x = 0,             # shift labels outside left
label.y = 1.02,          # above panel
font.label = list(size = 14, face = "plain"))  # face inside font.label
# Print the figure
Figure3
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf",
width = 5, height = 6)
# Assign ggarrange to Figure3
Figure3 <- ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),        # equal height for vertical layout
align = "v",             # vertical alignment
labels = c("a","b"),     # add panel labels
label.x = 0,             # shift labels outside left
label.y = 1.02,          # above panel
font.label = list(size = 14, face = "plain"))  # face inside font.label
# Print the figure
Figure3
dev.off()
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure3.pdf",
width = 5, height = 6)
# Assign ggarrange to Figure3
Figure3 <- ggarrange(Figure3a, Figure3b,
ncol = 1, nrow = 2,
heights = c(1,1),        # equal height for vertical layout
align = "v",             # vertical alignment
labels = c("a","b"),     # add panel labels
label.x = 0,             # shift labels outside left
label.y = 1.02,          # above panel
font.label = list(size = 14, face = "plain"))  # face inside font.label
# Print the figure
Figure3
dev.off()
datage<-read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/anage_data.csv", header=T)
datage$Species<-paste0(as.character(datage$genus)," ", as.character(datage$species))
datageclean <- datage%>% filter (dataquality %in% c("low","acceptable","high"))
#names(datbodymass)
datage
datageclean
names(datage)
# -----------------------------
# Fit Lambda ~ Year model (example)
# -----------------------------
# m_year_lambda <- update(Lambdamodel, .~. + Year, newdata=dathlambda, cores=4)
# Make sure you have predictions and credible intervals:
# dathlambda$pred, dathlambda$pred_lwr, dathlambda$pred_upr
# -----------------------------
# Layout: 3 top trend panels (larger), 3 bottom funnel plots
# -----------------------------
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure2.pdf", width = 9, height = 6)
layout_matrix <- matrix(c(1,2,3,
4,5,6), nrow=2, byrow=TRUE)
layout(layout_matrix, heights=c(1,1))  # top row taller
par(mar=c(5,4,2,2),family="Helvetica")
# -----------------------------
# Panel 1: Genetic diversity trend
# -----------------------------
datgencp <- datgencp[order(datgencp$Year), ]
#ylim_range <- range(c(datgencp$yi, datgencp$pred_lwr, datgencp$pred_upr))
plot(datgencp$Year, datgencp$yi,
pch=19, col=adjustcolor("orange2", alpha.f=0.4),
xlab="Year", ylab="Genetic diversity effect size",
main="", xlim=c(min(datgencp$Year), max(datgencp$Year)), ylim=c(-5,5))
lines(datgencp$Year, datgencp$pred, col="orange2", lwd=3)
polygon(c(datgencp$Year, rev(datgencp$Year)),
c(datgencp$pred_lwr, rev(datgencp$pred_upr)),
col=adjustcolor("orange2", alpha.f=0.2), border=NA)
mtext("a", side=3, line=0.5, at=min(datgencp$Year), cex=1.2, font=1)
# -----------------------------
# Panel 2: Population abundance trend
# -----------------------------
databuncp <- databuncp[order(databuncp$Year), ]
#ylim_range <- range(c(databuncp$yi, databuncp$pred_lwr, databuncp$pred_upr))
plot(databuncp$Year, databuncp$yi,
pch=19, col=adjustcolor("orange2", alpha.f=0.4),
xlab="Year", ylab="Population abundance effect size",
main="", xlim=c(min(databuncp$Year), max(databuncp$Year)), ylim=c(-2,2))
# lines(databuncp$Year, databuncp$pred, col="orange2", lwd=3)
# polygon(c(databuncp$Year, rev(databuncp$Year)),
#         c(databuncp$pred_lwr, rev(databuncp$pred_upr)),
#         col=adjustcolor("orange2", alpha.f=0.2), border=NA)
mtext("b", side=3, line=0.5, at=min(databuncp$Year), cex=1.2, font=1)
# -----------------------------
# Panel 3: Lambda trend
# -----------------------------
dathlambda <- dathlambda[order(dathlambda$Year), ]
ylim_range <- range(c(dathlambda$yi, dathlambda$pred_lwr, dathlambda$pred_upr))
plot(dathlambda$Year, dathlambda$yi,
pch=19, col=adjustcolor("orange2", alpha.f=0.4),
xlab="Year", ylab="Population growth rate effect size",
main="", xlim=c(min(dathlambda$Year), max(dathlambda$Year)), ylim=ylim_range)
# lines(dathlambda$Year, dathlambda$pred, col="orange2", lwd=3)
# polygon(c(dathlambda$Year, rev(dathlambda$Year)),
#         c(dathlambda$pred_lwr, rev(dathlambda$pred_upr)),
#         col=adjustcolor("orange2", alpha.f=0.4), border=NA)
mtext("c", side=3, line=0.5, at=min(dathlambda$Year), cex=1.2, font=1)
# -----------------------------
# Bottom row: funnel plots
# -----------------------------
funnel(Lambdamodelpb, yaxis="seinv", level=c(90,95,99),
shade=c("white","gray55","gray75"), ylab="Precision (1/SE)",
xlab="Population growth rate", cex.lab=1.2, col="orange2",
back="white", digits=1, xlim=c(-4,4), ylim=c(0.01,75))
mtext("d", side=3, line=0.5, at=-4, cex=1.2, font=1)
box()
funnel(genamodelpb, yaxis="seinv", level=c(90,95,99),
shade=c("white","gray55","gray75"), ylab="", xlab="Genetic diversity",
cex.lab=1.2, col=adjustcolor("orange2", alpha.f=0.4), back="white", digits=1, xlim=c(-4,4), ylim=c(0.01,75))
mtext("e", side=3, line=0.5, at=-4, cex=1.2, font=1)
box()
funnel(abunmodelpb, yaxis="seinv", level=c(90,95,99),
shade=c("white","gray55","gray75"), ylab="", xlab="Population abundance",
cex.lab=1.2, col=adjustcolor("orange2", alpha.f=0.4), back="white", digits=1, xlim=c(-4,4), ylim=c(0.01,75))
mtext("f", side=3, line=0.5, at=-4, cex=1.2, font=1)
box()
dev.off()
theme <-  theme(panel.background = element_blank(),
panel.border = element_rect(fill = NA),
strip.background = element_blank(),
axis.text.x = element_text(size = 10, colour = 'black'),
axis.text.y = element_text(size = 10, colour = 'black'),
#text        = element_text(size = 8),
axis.title.y = element_text(size = 10),# size of y lab
axis.title.x = element_text(size = 10),# size of X lab
legend.position     = "none",
text = element_text(family="Helvetica", size=10, face="plain"),
legend.title        = element_text(size = 9),
legend.text         = element_text(size = 8),
legend.key.height   = unit(0.8,'line'),
legend.background   = element_blank(),
legend.key          = element_rect(colour = NA, fill = NA),
plot.title  = element_text(hjust = 0.5),
plot.margin = margin(t = 0.5, r = 0.5, b = 0.5, l = 0.5, unit = "cm"))
out_all <- bind_rows(out_Lambda,out_f_abun, out_f_gen)
out_all_sum <-bind_rows(out_all_sum_lambda, out_all_sum_abun,out_all_sum_gen)
pdf("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Figure/Figure1.pdf", width = 6, height = 4)
(Figure1<-out_all %>%
ggplot(aes(b_Intercept, study,fill = after_stat(x < 0))) +
labs(x = "Effect size", y = '')+
xlim(-1.8,2)+
# Zero!
geom_vline(xintercept = 0, linewidth = .25, lty = 2) +
stat_halfeye(.width = c(.95)) +
scale_fill_manual(values = c("#FFC34D", "#999999"))+
# Add text labels
geom_text(size = 3,
data = mutate_if(out_all_sum, is.numeric, round, 2),
aes(label = str_glue("{b_Intercept} [{.lower}, {.upper}]"), x =-1.5),
hjust = "inward"
) +
annotate(geom="text", x=1.5, y=1, label="n=3812",size = 3,
color="black")+
annotate(geom="text", x=1.5, y=2, label="n=47",size = 3,
color="black")+
annotate(geom="text", x=1.5, y=3, label="n=17",size = 3,
color="black")+
theme)
dev.off()
rm(list = ls(all = TRUE))
# Load the required packages
library(taxize)
library(ape)
library(phytools)
library(ade4)
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(tidytree)
library(aplot)
library(cowplot)
library(ggpubr)
library(ggsci)
library(R.rsp)
library(flextable)
library(effectsize)
library(metafor)
library(esc)
library(knitr)
library(tidyverse)
library(brms)
library(coda)
library(modelr)
library(gridExtra)
library(pBrackets)
library(performance)
library(kableExtra)
library(tidybayes)
library(formattable)
library(grid)
library(rstan)
library(lme4)
library(lmerTest)
library(BIEN)
library(readr)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(stringr)
library(tidyr)
library(writexl)
#library(scater)
rstan_options(auto_write = TRUE)
set.seed(13)
Lambdacp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Lambda.csv", header = T)
datlambdacp <- escalc("SMDH", m1i = mcenter, m2i = mperiphery, sd1i = sdcenter, sd2i = sdperiphery, n1i = ncenter, n2i = nperiphery, slab = Author, data = Lambdacp)
Lambdar <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Lambdar.csv", header = T)
# Convert r to numeric
Lambdar <- Lambdar %>% mutate(r = as.numeric(r))
# Function to convert r to d and compute vd
r_to_d <- function(r, vr) {
d <- 2 * r / sqrt(1 - r^2)
vd <- 4 * vr / (1 - r^2)^3
return(list(d = d, vd = vd))
}
# Compute vr, d, vd, Hedges' g, and vg
Lambdar <- Lambdar %>%
mutate(vr = (1 - r^2)^2 / (n - 1)) %>%        # approximate variance of r
rowwise() %>%
mutate(
temp = list(r_to_d(r, vr)),
d = temp$d,
vd = temp$vd,
J = 1 - (3 / (4*n - 9)),                   # Hedges' g correction factor
g = d * J,
vg = vd * J^2
) %>%
select(-temp)
#view(Lambdar)
# Prepare Lambdar to match datlambdacp
Lambdar_prep <- Lambdar %>%
select(Author, Year, Kingdom, Species, Method, g, vg) %>%  # keep relevant cols
rename(
yi = g,
vi = vg
)
# Prepare datlambdacp (keep only relevant columns)
datlambdacp_prep <- datlambdacp %>%
select(Author, Year, Kingdom, Species, Method, yi, vi)
datlambda<-rbind(datlambdacp_prep,Lambdar_prep)
datlambda$se<-sqrt(datlambda$vi)
datlambda <- datlambda %>%
# create a study identifier based on Author and Year
mutate(ID = as.integer(factor(paste(Author, Year)))) %>%
# move study_ID to the first column
select(ID, everything())
datlambda$ID<-as.factor(datlambda$ID)
write.csv(datlambda, "/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Final/datlambda.csv", row.names = FALSE)
gencp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/genetic.csv", header = T)
datgen <- escalc("SMDH", m1i = mcenter, m2i = mperiphery, sd1i = sdcenter, sd2i = sdperiphery, n1i = ncenter, n2i = nperiphery, slab = Author, data = gencp)
genr <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/geneticr.csv", header = T)
# Ensure r is numeric
genr <- genr %>% mutate(r = as.numeric(r))
# Function to convert r to d and compute vd
r_to_d <- function(r, vr) {
d <- 2 * r / sqrt(1 - r^2)
vd <- 4 * vr / (1 - r^2)^3
return(list(d = d, vd = vd))
}
# Compute vr, d, vd, Hedges' g, and vg
genr <- genr %>%
mutate(vr = (1 - r^2)^2 / (n - 1)) %>%        # approximate variance of r
rowwise() %>%
mutate(
temp = list(r_to_d(r, vr)),
d = temp$d,
vd = temp$vd,
J = 1 - (3 / (4*n - 9)),                   # Hedges' g correction factor
g = d * J,
vg = vd * J^2
) %>%
select(-temp)
# Prepare genr for meta-analysis
genr_prep <- genr %>%
select(Author, Year, Kingdom, Species, Method, g, vg) %>%
rename(yi = g, vi = vg)
# If you have a previous datlambdacp dataset
datgen_prep <- datgen %>%
select(Author, Year, Kingdom, Species, Method, yi, vi)
# Combine datasets
datgencp <- bind_rows(datgen_prep, genr_prep)
# Add standard errors and study IDs
datgencp <- datgencp %>%
mutate(
se = sqrt(vi),
ID = as.factor(as.integer(factor(paste(Author, Year))))
) %>%
select(ID, everything()) %>%
na.omit()
write.csv(datgencp, "/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Final/datgencp.csv", row.names = FALSE)
Abundcp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Abundance.csv", header = T)
Abundcp$Species<-gsub("spp.","sp.",as.character(Abundcp$Species))
#Abundcp$Species<-gsub("sp.","",as.character(Abundcp$Species))
databun <- escalc("ZCOR", ri = correlation.coefficient, ni = sample_size, data = Abundcp)
databun <- escalc("ZCOR", ri = correlation.coefficient, ni = sample_size, data = Abundcp)
Abundcp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Abundancez.csv", header = T)
databuncp<-rbind(databun,Abundcp)
databun <- escalc("ZCOR", ri = correlation.coefficient, ni = sample_size, data = Abundcp)
Abundcp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Abundancez.csv", header = T)
databuncp<-rbind(databun,Abundcp)
databuncp<-databun[!apply(databun[,c("yi", "vi")], 1, anyNA),]
databuncp$se<-sqrt(databuncp$vi)
databuncp <- databuncp %>%
# create a study identifier based on Author and Year
mutate(ID = as.integer(factor(paste(Author, Year)))) %>%
# move study_ID to the first column
select(ID, everything())
databuncp$ID<-as.factor(databuncp$ID)
databuncp <- databuncp %>%
filter(!is.na(yi) & !is.na(vi) & !is.na(se))
# Export the combined dataset
write.csv(databuncp, "/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Final/databuncp.csv", row.names = FALSE)
Abundcp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Abundance.csv", header = T)
Abundcp$Species<-gsub("spp.","sp.",as.character(Abundcp$Species))
databun <- escalc("ZCOR", ri = correlation.coefficient, ni = sample_size, data = Abundcp)
Abundcp$sample_size <- as.numeric(as.character(Abundcp$sample_size))
databun <- escalc("ZCOR", ri = correlation.coefficient, ni = sample_size, data = Abundcp)
Abundcp <- read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Abundancez.csv", header = T)
databuncp<-rbind(databun,Abundcp)
databuncp<-databun[!apply(databun[,c("yi", "vi")], 1, anyNA),]
databuncp$se<-sqrt(databuncp$vi)
databuncp <- databuncp %>%
# create a study identifier based on Author and Year
mutate(ID = as.integer(factor(paste(Author, Year)))) %>%
# move study_ID to the first column
select(ID, everything())
databuncp$ID<-as.factor(databuncp$ID)
databuncp
databuncp <- databuncp %>%
filter(!is.na(yi) & !is.na(vi) & !is.na(se))
# Export the combined dataset
write.csv(databuncp, "/Users/jm200/Library/CloudStorage/Dropbox/Moutouama Lab/Manuscripts/Meta-analysis-Center-periphery-hypothesis/Data/Final/databuncp.csv", row.names = FALSE)
